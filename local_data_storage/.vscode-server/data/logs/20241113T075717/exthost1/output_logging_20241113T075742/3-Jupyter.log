Visual Studio Code (1.95.2, attached-container, desktop)
Jupyter Extension Version: 2024.10.0.
Python Extension Version: 2024.20.0.
Pylance Extension Version: 2024.11.1.
Platform: linux (x64).
Temp Storage folder ~/.vscode-server/data/User/globalStorage/ms-toolsai.jupyter/version-2024.10.0
Workspace folder /container/pyspark_workspace, Home = /root
08:00:41.225 [info] Starting Kernel (Python Path: /usr/local/bin/python, Unknown, 2.7.undefined) for '/container/pyspark_workspace/source_code/sample_code/Test_Kafka.ipynb' (disableUI=true)
08:00:41.460 [warn] Disposing old controller startUsingPythonInterpreter:'.jvsc74a57bd06699b966c21a81be21759e40053de52c009daad87cbe5a3dc643468ce4ab3367.d:\Program Files\Python\python.exe.d:\Program Files\Python\python.exe.-m#ipykernel_launcher' for view = 'jupyter-notebook'
08:00:41.463 [warn] Disposing old controller startUsingPythonInterpreter:'.jvsc74a57bd06699b966c21a81be21759e40053de52c009daad87cbe5a3dc643468ce4ab3367.d:\Program Files\Python\python.exe.d:\Program Files\Python\python.exe.-m#ipykernel_launcher (Interactive)' for view = 'interactive'
08:00:41.589 [warn] Failed to get activated env vars for /usr/local/bin/python in 280ms
08:00:41.623 [info] Process Execution: /usr/local/bin/python -c "import site;print("USER_BASE_VALUE");print(site.USER_BASE);print("USER_BASE_VALUE");"
08:00:41.712 [info] Process Execution: /usr/local/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
08:00:42.042 [warn] Failed to get activated env vars for /usr/local/bin/python in 264ms
08:00:42.068 [info] Process Execution: /usr/local/bin/python -m ipykernel_launcher --f=/~/.local/share/jupyter/runtime/kernel-v38866bddf01f9470e3cb1837d1d680ec3c10712c2.json
    > cwd: //container/pyspark_workspace/source_code/sample_code
08:00:42.203 [warn] Failed to get activated env vars for /usr/local/bin/python in 352ms
08:00:42.219 [info] Process Execution: /usr/local/bin/python -m pip list
08:00:46.259 [info] Kernel successfully started
08:00:46.302 [info] Process Execution: /usr/local/bin/python /~/.vscode-server/extensions/ms-toolsai.jupyter-2024.10.0-linux-x64/pythonFiles/printJupyterDataDir.py
08:00:47.409 [warn] Cell completed with errors iu [Error]: name 'SparkSession' is not defined
    at n.execute (/~/.vscode-server/extensions/ms-toolsai.jupyter-2024.10.0-linux-x64/dist/extension.node.js:297:4958) {
  ename: 'NameError',
  evalue: "name 'SparkSession' is not defined",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mNameError\x1B[0m                                 Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[1], line 1\x1B[0m\n' +
      '\x1B[0;32m----> 1\x1B[0m builder \x1B[38;5;241m=\x1B[39m \x1B[43mSparkSession\x1B[49m\x1B[38;5;241m.\x1B[39mbuilder\x1B[38;5;241m.\x1B[39mappName(session_id) \\\n' +
      '\x1B[1;32m      2\x1B[0m     \x1B[38;5;241m.\x1B[39mmaster(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mspark://spark-master:7077\x1B[39m\x1B[38;5;124m"\x1B[39m)\\\n' +
      '\x1B[1;32m      3\x1B[0m     \x1B[38;5;241m.\x1B[39mconfig(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mspark.jars.packages\x1B[39m\x1B[38;5;124m"\x1B[39m, \x1B[38;5;124m"\x1B[39m\x1B[38;5;124morg.apache.spark:spark-sql-kafka-0-10_2.12:3.4.0\x1B[39m\x1B[38;5;124m"\x1B[39m)\\\n' +
      '\x1B[1;32m      4\x1B[0m     \x1B[38;5;241m.\x1B[39mconfig(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mspark.sql.extensions\x1B[39m\x1B[38;5;124m"\x1B[39m, \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mio.delta.sql.DeltaSparkSessionExtension\x1B[39m\x1B[38;5;124m"\x1B[39m) \\\n' +
      '\x1B[1;32m      5\x1B[0m     \x1B[38;5;241m.\x1B[39mconfig(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mspark.sql.catalog.spark_catalog\x1B[39m\x1B[38;5;124m"\x1B[39m, \x1B[38;5;124m"\x1B[39m\x1B[38;5;124morg.apache.spark.sql.delta.catalog.DeltaCatalog\x1B[39m\x1B[38;5;124m"\x1B[39m)\n' +
      '\x1B[1;32m      7\x1B[0m spark \x1B[38;5;241m=\x1B[39m configure_spark_with_delta_pip(builder)\x1B[38;5;241m.\x1B[39mgetOrCreate()    \n' +
      '\x1B[1;32m      8\x1B[0m \x1B[38;5;66;03m# spark.sparkContext.setLogLevel("WARN")\x1B[39;00m\n',
    "\x1B[0;31mNameError\x1B[0m: name 'SparkSession' is not defined"
  ]
}
08:01:55.841 [info] Disposing request as the cell (-1) was deleted /container/pyspark_workspace/source_code/sample_code/Test_Kafka.ipynb
09:40:49.881 [info] Dispose Kernel '/container/pyspark_workspace/source_code/sample_code/Test_Kafka.ipynb' associated with '/container/pyspark_workspace/source_code/sample_code/Test_Kafka.ipynb'
09:40:51.826 [warn] Failed to delete connection file file:///~/.local/share/jupyter/runtime/kernel-v38866bddf01f9470e3cb1837d1d680ec3c10712c2.json for pid 2164 Canceled (FileSystemError): Canceled
    at Function.e (file:///~/.vscode-server/bin/e8653663e8840adaf45af01eab5c627a5af81807/out/vs/workbench/api/node/extensionHostProcess.js:114:9853)
    at Object.stat (file:///~/.vscode-server/bin/e8653663e8840adaf45af01eab5c627a5af81807/out/vs/workbench/api/node/extensionHostProcess.js:114:7007)
    at Bc.delete (/~/.vscode-server/extensions/ms-toolsai.jupyter-2024.10.0-linux-x64/dist/extension.node.js:239:15448)
    at /~/.vscode-server/extensions/ms-toolsai.jupyter-2024.10.0-linux-x64/dist/extension.node.js:303:469 {
  code: 'Unknown'
}
